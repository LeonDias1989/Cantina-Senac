package br.com.senac.relatorios;

import java.sql.Date;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Calendar;

import br.com.senac.lib.DataBase;

public class RelatorioDAODB extends DataBase {

	public String getVendasPorCliente(String matricula) {

		String aux = "";
		ResultSet resultSet;
		try {
			iniciarConexão("select (select nome from cliente where matricula = clienteFK), datavenda,(select nomeProduto from produto  where codigo = itemdevenda.id_produto_fk) from venda inner join itemdevenda on  venda.id_venda = itemDevenda.idvenda_FK and venda.clienteFK = ?");

			preparedStatement.setString(1, matricula);

			resultSet = preparedStatement.executeQuery();

			while (resultSet.next()) {

				aux += resultSet.getString("nome");
				aux += "|";
				aux += resultSet.getString("dataVenda");
				aux += "|";
				aux += resultSet.getString("nomeproduto");
				aux += "\n";

			}

		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		return aux;
	}

	public String getVendasPorFuncionario(String codigo) {

		String aux = "";
		ResultSet resultSet;
		try {
			iniciarConexão("select  (select nome from funcionario where codigo = funcionarioFK), datavenda,(select nomeProduto from produto  where codigo = itemdevenda.id_produto_fk) from venda inner join itemdevenda on  venda.id_venda = itemDevenda.idvenda_FK and funcionarioFK = '2'");

			resultSet = preparedStatement.executeQuery();

			while (resultSet.next()) {

				aux += resultSet.getString("nome");
				aux += "|";
				aux += resultSet.getString("dataVenda");
				aux += "|";
				aux += resultSet.getString("nomeproduto");
				aux += "\n";

			}

		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		return aux;
	}

	public String getVendasPorData(String dataVenda) {

		

		ResultSet resultSet;
		String aux = "";

		try {
			iniciarConexão("select (select nome from cliente where matricula = clienteFK), (select nome from funcionario where codigo = funcionarioFK), datavenda,(select nomeproduto from produto  where codigo = itemdevenda.id_produto_fk) from venda inner join itemdevenda on  venda.id_venda = itemDevenda.idvenda_FK and venda.datavenda  = ? ");

			preparedStatement.setInt(1, date.getDate());
			
			resultSet = preparedStatement.executeQuery();

			while (resultSet.next()) {
				aux += resultSet.getString("nomecliente");
				aux += "|";
				aux += resultSet.getString("nome");
				aux += "|";
				aux += resultSet.getString("dataVenda");
				aux += "|";
				aux += resultSet.getString("nomeproduto");
				aux += "\n";
			}

		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		return aux;
	}

	public static void main(String[] args) {

		java.util.Date dataUtil = new java.util.Date();
		Date date = new Date(dataUtil.getTime());

		long tempoLong = date.parse("2014-06-29");

		date.setTime(tempoLong);

	}

}
