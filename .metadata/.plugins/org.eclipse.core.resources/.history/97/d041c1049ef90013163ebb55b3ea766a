package base_testes.realizar_vendas;

import java.util.ArrayList;
import java.util.List;

import br.com.senac.dao.DataBase;
import br.com.senac.model.Cliente;
import br.com.senac.model.Produto;

public class Venda extends DataBase {

	private List<br.com.senac.model.Produto> carrinho;
	private boolean finalizada;

	public Venda() {
		super();
		carrinho = new ArrayList<>();
		this.finalizada = false;
	}

	public boolean isFinalizada() {
		return finalizada;
	}

	public List<br.com.senac.model.Produto> getCarrinho() {
		return carrinho;
	}

	public void comprarProduto(Cliente cliente) {

		if (valorTotal() <= cliente.getSaldo() && isFinalizada() == false) {

			cliente.setSaldo(cliente.getSaldo() - valorTotal());
			System.out.println("Compra realizada com sucesso");
			finalizada = true;
		} else
			System.out.println("Saldo insuficiente ou venda já finalizada");
	}

	public void estornarVenda(Conta conta) {

		if (isFinalizada()) {

			conta.setSaldo(conta.getSaldo() + this.valorTotal());
			System.out.println("Venda cancelada");
		} else
			System.out.println("Venda em andamento");

	}

	private double valorTotal() {

		double valorTotal = 0;

		for (Produto p : carrinho) {
			valorTotal += p.getPreco();
		}
		return valorTotal;

	}

	public void adicionarAoCarrinho(br.com.senac.model.Produto produto) {

		if (isFinalizada() == false)
			carrinho.add(produto);
		else
			System.out
					.println("Não é possível adicionar mais ítens ao carrinho\n"
							+ "Venda já finalizada");
	}

}
